# python-for-data
Python for data


## üìä –ê–Ω–∞–ª—ñ–∑ –¥–∞—Ç–∞—Å–µ—Ç—É —Ñ—ñ–ª—å–º—ñ–≤ —ñ–∑ movies_metadata.csv

–¶—è –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∏–∫–æ–Ω—É—î –±–∞–∑–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö —ñ–∑ —Ñ–∞–π–ª—É movies_metadata.csv, –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö, –æ–±—Ä–æ–±–∫—É –∂–∞–Ω—Ä—ñ–≤ —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö –∂–∞–Ω—Ä—ñ–≤ —É –≤–∏–≥–ª—è–¥—ñ –±–∞—Ä–ø–ª–æ—Ç—É.


## üì• 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫ —Ç–∞ –¥–∞–Ω–∏—Ö

–£ –ø—Ä–æ–µ–∫—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ç–∞–∫—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:

- **pandas** ‚Äî —Ä–æ–±–æ—Ç–∞ –∑ —Ç–∞–±–ª–∏—Ü—è–º–∏  
- **numpy** ‚Äî —Ä–æ–±–æ—Ç–∞ –∑ –º–∞—Å–∏–≤–∞–º–∏  
- **matplotlib** —ñ **seaborn** ‚Äî –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è  
- **ast** ‚Äî –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó —Ä—è–¥–∫—ñ–≤ —É Python-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ (–¥–ª—è –∂–∞–Ω—Ä—ñ–≤)

–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:

```python
df = pd.read_csv("data/movies_metadata.csv")

–î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∑ —Ñ–∞–π–ª—É:

df = pd.read_csv("data/movies_metadata.csv")

–§–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å 45466 —Ä—è–¥–∫—ñ–≤ —ñ 24 —Å—Ç–æ–≤–ø—Ü—ñ:

RangeIndex: 45466 entries, 0 to 45465
Data columns (total 24 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   adult                  45466 non-null  object 
 1   belongs_to_collection  45466 non-null  object 
 2   budget                 45466 non-null  object 
 3   genres                 45466 non-null  object 
 4   homepage               45466 non-null  object 
 5   id                     45466 non-null  object 
 6   imdb_id                45449 non-null  object 
 7   original_language      45455 non-null  object 
 8   original_title         45466 non-null  object 
 9   overview               44512 non-null  object 
 10  popularity             45461 non-null  object 
 11  poster_path            45080 non-null  object 
 12  production_companies   45463 non-null  object 
 13  production_countries   45463 non-null  object 
 14  release_date           45379 non-null  object 
 15  revenue                45460 non-null  float64
 16  runtime                45203 non-null  float64
 17  spoken_languages       45460 non-null  object 
 18  status                 45379 non-null  object 
 19  tagline                45466 non-null  object 
 20  title                  45460 non-null  object 
 21  video                  45460 non-null  object 
 22  vote_average           45460 non-null  float64
 23  vote_count             45460 non-null  float64

df.head()         üëâ –í–∏–≤–æ–¥–∏—Ç—å –ø–µ—Ä—à—ñ 5 —Ä—è–¥–∫—ñ–≤ DataFrame.
df.info()         üëâ –í–∏–≤–æ–¥–∏—Ç—å –∑–∞–≥–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ DataFrame (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ —ñ —Å—Ç–æ–≤–ø—Ü—ñ–≤, —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ, –æ–±—Å—è–≥ –ø–∞–º º—è—Ç—ñ)
df.describe()     üëâ –ü–æ–∫–∞–∑—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –æ–ø–∏—Å —á–∏—Å–ª–æ–≤–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤ (c–µ—Ä–µ–¥–Ω—î, –º—ñ–Ω—ñ–º—É–º, –º–∞–∫—Å–∏–º—É–º, –∫–≤–∞—Ä—Ç–∏–ª—ñ —Ç–æ—â–æ)
df.isnull().sum() üëâ –í–∏–≤–æ–¥–∏—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ (–¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ –ø–µ—Ä–µ–¥ –æ–±—Ä–æ–±–∫–æ—é –¥–∞–Ω–∏—Ö)

üßπ 2. –ü–µ—Ä–≤–∏–Ω–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

–£ —Ü—å–æ–º—É –±–ª–æ—Ü—ñ –∫–æ–¥—É –º–∏ –∑–∞–ø–æ–≤–Ω—é—î–º–æ –ø—Ä–æ–ø—É—â–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è (NaN) —É –¥–≤–æ—Ö —Å—Ç–æ–≤–ø—Ü—è—Ö DataFrame, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–º–∏–ª–æ–∫ –ø—ñ–¥ —á–∞—Å –∞–Ω–∞–ª—ñ–∑—É –∞–±–æ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó.

‚úîÔ∏è df["tagline"].fillna("without tagline")

–ó–∞–ø–æ–≤–Ω—é—î –≤—Å—ñ –ø–æ—Ä–æ–∂–Ω—ñ (NaN) –∑–Ω–∞—á–µ–Ω–Ω—è —É —Å—Ç–æ–≤–ø—Ü—ñ tagline.
–Ø–∫—â–æ —É —Ñ—ñ–ª—å–º—É –Ω–µ–º–∞—î —Å–ª–æ–≥–∞–Ω—É ‚Äî –º–∏ –ø—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ "without tagline".
–¶–µ –¥–æ–∑–≤–æ–ª—è—î —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–ø—É—Å–∫—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –∑–ª–∞–º–∞—Ç–∏ –ø–æ–¥–∞–ª—å—à–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç–µ–∫—Å—Ç—É.

‚úîÔ∏è df.homepage.fillna("no homepage")

–ó–∞–º—ñ–Ω—é—î –≤—Å—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ URL —É —Å—Ç–æ–≤–ø—Ü—ñ homepage –∑–Ω–∞—á–µ–Ω–Ω—è–º "no homepage".
–î–æ–∑–≤–æ–ª—è—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ —ñ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–ø—É—â–µ–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏.

‚úîÔ∏è  df.dropna(inplace=True)

–¶–µ–π –º–µ—Ç–æ–¥ –≤–∏–¥–∞–ª—è—î –≤—Å—ñ —Ä—è–¥–∫–∏ DataFrame, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —Ö–æ—á–∞ –± –æ–¥–Ω–µ –ø—Ä–æ–ø—É—â–µ–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (NaN).

inplace=True –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–º—ñ–Ω–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ DataFrame. –¢–æ–±—Ç–æ df –±—É–¥–µ –∑–º—ñ–Ω–µ–Ω–æ "–Ω–∞ –º—ñ—Å—Ü—ñ", —ñ –∑–∞–π–≤—ñ —Ä—è–¥–∫–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤ –Ω–æ–≤—ñ–π –∑–º—ñ–Ω–Ω—ñ–π.


üé¨ 3. –û–±—Ä–æ–±–∫–∞ –∂–∞–Ω—Ä—ñ–≤

–§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è JSON-–ø–æ–¥—ñ–±–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤ –Ω–∞ —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä—ñ–≤

def extract_genres(genre_str):
    try:
        genres = ast.literal_eval(genre_str)
        return [genre["name"] for genre in genres]
    except ValueError:
        return []

–ü–æ—è—Å–Ω–µ–Ω–Ω—è:

def extract_genres(genre_str):  # –°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –ø—Ä–∏–π–º–∞—î —Ä—è–¥–æ–∫ –∑ –æ–ø–∏—Å–æ–º –∂–∞–Ω—Ä—ñ–≤.
genres = ast.literal_eval(genre_str)  # –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–∫—Å—Ç —É —Ñ–æ—Ä–º–∞—Ç—ñ "[{'id': 18, 'name': 'Drama'}, ...]" —É —Å–ø—Ä–∞–≤–∂–Ω—ñ–π Python-—Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–Ω–∏–∫—ñ–≤.
ast.literal_eval –±–µ–∑–ø–µ—á–Ω–æ —á–∏—Ç–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∑ —Ä—è–¥–∫–∞.

return [genre["name"] for genre in genres] # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Å–ø–∏—Å–æ–∫ –ª–∏—à–µ –Ω–∞–∑–≤ –∂–∞–Ω—Ä—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: ["Drama", "Action", "Comedy"].

except ValueError: -> –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø–∞—Ä—Å–∏—Ç–∏ —Ä—è–¥–æ–∫ (–ø–æ–º–∏–ª–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç)‚Ä¶
return []  -> –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫

df["genres"] = df["genres"].apply(extract_genres)

–ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é extract_genres –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ —Å—Ç–æ–≤–ø—Ü—è genres.
–ó–∞–º—ñ—â—É—î–º–æ —Å—Ç–∞—Ä–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å genres –Ω–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏: —Ç–µ–ø–µ—Ä –∫–æ–∂–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç ‚Äî —Ü–µ —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä—ñ–≤, –∞ –Ω–µ —Ä—è–¥–æ–∫.

all_genres = df['genres'].explode()  # –†–æ–∑–ø–∞–∫–æ–≤—É—î–º–æ —Å–ø–∏—Å–∫–∏ –∂–∞–Ω—Ä—ñ–≤ —É —Å—Ç–æ–≤–ø—Ü—ñ
genres_counts = all_genres.value_counts() # –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î–º–æ, —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –∫–æ–∂–Ω–∏–π –∂–∞–Ω—Ä.

print(genres_counts.index) # –Ω–∞–∑–≤–∏ –≤—Å—ñ—Ö –∂–∞–Ω—Ä—ñ–≤
print(genres_counts.values) # —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è —Ü–µ–π –∂–∞–Ω—Ä


üìà 4. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ –∂–∞–Ω—Ä—ñ–≤

–°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –±–∞—Ä–ø–ª–æ—Ç —ñ–∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ñ—ñ–ª—å–º—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É –∂–∞–Ω—Ä—ñ:

plt.figure(figsize=(10,6)) # –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—É —Ñ—ñ–≥—É—Ä—É (–ø–æ–ª–æ—Ç–Ω–æ) –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞.

sns.barplot(x=genres_counts.index, y=genres_counts.values) # –ë—É–¥—É—î–º–æ —Å—Ç–æ–≤–ø—á–∏–∫–æ–≤—É –¥—ñ–∞–≥—Ä–∞–º—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Seaborn.

# x=genres_counts.index ‚Äî –Ω–∞–∑–≤–∏ –∂–∞–Ω—Ä—ñ–≤ (Drama, Comedy, Action‚Ä¶).
# y=genres_counts.values ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∂–∞–Ω—Ä—É.

plt.title("Count film for genres") # –î–æ–¥–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ –≥—Ä–∞—Ñ—ñ–∫–∞
plt.xlabel("genres")
plt.ylabel("counts")

plt.xticks(rotation=45) # –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø—ñ–¥–ø–∏—Å–∏ –∂–∞–Ω—Ä—ñ–≤ –Ω–∞ 45¬∞, —â–æ–± –≤–æ–Ω–∏ –Ω–µ –Ω–∞–∫–ª–∞–¥–∞–ª–∏—Å—è –æ–¥–∏–Ω –Ω–∞ –æ–¥–Ω–æ–≥–æ —Ç–∞ –±—É–ª–∏ —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–º–∏.

plt.show() # –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ –≥—Ä–∞—Ñ—ñ–∫ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ

![alt text](image-1.png)
